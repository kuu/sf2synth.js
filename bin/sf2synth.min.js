/** @license sf2synth.js 2013 - imaya / GREE Inc. [ https://github.com/gree/sf2synth.js ] The MIT License */(function() {'use strict';function k(d){throw d;}var m=void 0,n=null,u=!1,v=this;function w(d,c){var a=d.split("."),b=v;!(a[0]in b)&&b.execScript&&b.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&c!==m?b[e]=c:b=b[e]?b[e]:b[e]={}};function y(d,c,a){this.c=d;this.destination=c;this.b=a;this.aa=a.channel;this.key=a.key;this.Aa=a.velocity;this.buffer=a.sample;this.playbackRate=a.basePlaybackRate;this.sampleRate=a.sampleRate;this.volume=a.volume;this.S=a.panpot;this.l=a.pitchBend;this.q=a.pitchBendSensitivity;this.ia=a.modEnvToPitch;this.startTime=d.currentTime;this.u=this.playbackRate}
y.prototype.noteOn=function(){var d=this.c,c=this.b,a=this.buffer,b,e,f,g=this.c.currentTime,h=g+c.volAttack,q=g+c.modAttack,l=h+c.volDecay,p=q+c.modDecay;e=c.loopStart/this.sampleRate;f=c.loopEnd/this.sampleRate;var r=c.start/this.sampleRate,a=a.subarray(0,a.length+c.end);b=this.Z=d.createBuffer(1,a.length,this.sampleRate);b.getChannelData(0).set(a);a=this.t=d.createBufferSource();a.buffer=b;a.loop=9!==this.aa;a.loopStart=e;a.loopEnd=f;A(this,this.l);b=this.ma=d.createPanner();e=this.I=d.createGainNode();
f=e.gain;d=this.filter=d.createBiquadFilter();d.type=d.LOWPASS;b.panningModel=0;b.setPosition(Math.sin(this.S*Math.PI/2),0,Math.cos(this.S*Math.PI/2));f.setValueAtTime(0,g);f.linearRampToValueAtTime(this.volume*(this.Aa/127),h);f.linearRampToValueAtTime(this.volume*(1-c.volSustain),l);d.Q.setValueAtTime(c.initialFilterQ*Math.pow(10,200),g);h=440*Math.pow(2,(c.initialFilterFc-6900)/1200);l=440*Math.pow(2,(c.initialFilterFc+c.modEnvToFilterFc-6900)/1200);c=h+(l-h)*(1-c.modSustain);d.frequency.setValueAtTime(h,
g);d.frequency.linearRampToValueAtTime(l,q);d.frequency.linearRampToValueAtTime(c,p);a.connect(d);d.connect(b);b.connect(e);e.connect(this.destination);a.start(0,r)};
y.prototype.noteOff=function(){var d=this.b,c=this.t,a=this.I,b=this.c.currentTime,e=b+d.volRelease,b=b+d.modRelease;this.Z&&(a.gain.cancelScheduledValues(0),a.gain.linearRampToValueAtTime(0,e),c.playbackRate.cancelScheduledValues(0),c.playbackRate.linearRampToValueAtTime(this.u,b),c.loop=u,c.stop(e),setTimeout(function(a){return function(){a.t.disconnect(0);a.ma.disconnect(0);a.I.disconnect(0)}}(this),1E3*d.volRelease))};
function A(d,c){d.u=d.playbackRate*Math.pow(Math.pow(2,1/12),d.q*(c/(0>c?8192:8191))*d.b.scaleTuning);var a=d.t.playbackRate,b=d.u,e=d.startTime,f=d.b,g=e+f.modAttack,h=g+f.modDecay,q=b*Math.pow(Math.pow(2,1/12),d.ia*d.b.scaleTuning);a.cancelScheduledValues(0);a.setValueAtTime(b,e);a.linearRampToValueAtTime(q,g);a.linearRampToValueAtTime(b+(q-b)*(1-f.modSustain),h)};function C(d,c){c=c||{};this.input=d;this.j=c.index||0;this.length=c.length||d.length-this.j;this.offset=this.j;this.padding=c.padding!==m?c.padding:!0;this.$=c.bigEndian!==m?c.bigEndian:u}function aa(d,c,a){this.type=d;this.size=c;this.offset=a}
C.prototype.parse=function(){var d=this.length+this.offset;for(this.g=[];this.j<d;){var c=this.input,a=this.j,b=m;this.g.push(new aa(String.fromCharCode(c[a++],c[a++],c[a++],c[a++]),b=this.$?(c[a++]<<24|c[a++]<<16|c[a++]<<8|c[a++])>>>0:(c[a++]|c[a++]<<8|c[a++]<<16|c[a++]<<24)>>>0,a));a+=b;this.padding&&1===(a-this.offset&1)&&a++;this.j=a}};function D(d,c){var a=d.g[c];return a===m?n:a};function I(d,c){c=c||{};this.input=d;this.na=c.parserOption}
I.prototype.parse=function(){var d,c,a=new C(this.input,this.na);a.parse();1!==a.g.length&&k(Error("wrong chunk length"));a=D(a,0);a===n&&k(Error("chunk not found"));var b=this.input,e=a.offset,f;"RIFF"!==a.type&&k(Error("invalid chunk type:"+a.type));f=String.fromCharCode(b[e++],b[e++],b[e++],b[e++]);"sfbk"!==f&&k(Error("invalid signature:"+f));a=new C(b,{index:e,length:a.size-4});a.parse();3!==a.g.length&&k(Error("invalid sfbk structure"));b=D(a,0);e=this.input;f=b.offset;var g;"LIST"!==b.type&&
k(Error("invalid chunk type:"+b.type));g=String.fromCharCode(e[f++],e[f++],e[f++],e[f++]);"INFO"!==g&&k(Error("invalid signature:"+g));(new C(e,{index:f,length:b.size-4})).parse();b=D(a,1);e=this.input;f=b.offset;"LIST"!==b.type&&k(Error("invalid chunk type:"+b.type));g=String.fromCharCode(e[f++],e[f++],e[f++],e[f++]);"sdta"!==g&&k(Error("invalid signature:"+g));b=new C(e,{index:f,length:b.size-4});b.parse();1!==b.g.length&&k(Error("TODO"));this.Y=D(b,0);a=D(a,2);b=this.input;e=a.offset;"LIST"!==
a.type&&k(Error("invalid chunk type:"+a.type));f=String.fromCharCode(b[e++],b[e++],b[e++],b[e++]);"pdta"!==f&&k(Error("invalid signature:"+f));a=new C(b,{index:e,length:a.size-4});a.parse();9!==a.g.length&&k(Error("invalid pdta chunk"));b=D(a,0);e=this.input;f=b.offset;g=this.qa=[];var h=b.offset+b.size;for("phdr"!==b.type&&k(Error("invalid chunk type:"+b.type));f<h;)g.push({ra:String.fromCharCode.apply(n,e.subarray(f,f+=20)),pa:e[f++]|e[f++]<<8,d:e[f++]|e[f++]<<8,U:e[f++]|e[f++]<<8,Ca:(e[f++]|e[f++]<<
8|e[f++]<<16|e[f++]<<24)>>>0,Ba:(e[f++]|e[f++]<<8|e[f++]<<16|e[f++]<<24)>>>0,Da:(e[f++]|e[f++]<<8|e[f++]<<16|e[f++]<<24)>>>0});b=D(a,1);e=this.input;f=b.offset;g=this.sa=[];h=b.offset+b.size;for("pbag"!==b.type&&k(Error("invalid chunk type:"+b.type));f<h;)g.push({V:e[f++]|e[f++]<<8,v:e[f++]|e[f++]<<8});b=D(a,2);"pmod"!==b.type&&k(Error("invalid chunk type:"+b.type));this.X=J(this,b);b=D(a,3);"pgen"!==b.type&&k(Error("invalid chunk type:"+b.type));this.W=K(this,b);b=D(a,4);e=this.input;f=b.offset;
g=this.b=[];h=b.offset+b.size;for("inst"!==b.type&&k(Error("invalid chunk type:"+b.type));f<h;)g.push({fa:String.fromCharCode.apply(n,e.subarray(f,f+=20)),K:e[f++]|e[f++]<<8});b=D(a,5);e=this.input;f=b.offset;g=this.ga=[];h=b.offset+b.size;for("ibag"!==b.type&&k(Error("invalid chunk type:"+b.type));f<h;)g.push({L:e[f++]|e[f++]<<8,ea:e[f++]|e[f++]<<8});b=D(a,6);"imod"!==b.type&&k(Error("invalid chunk type:"+b.type));this.N=J(this,b);b=D(a,7);"igen"!==b.type&&k(Error("invalid chunk type:"+b.type));
this.M=K(this,b);h=D(a,8);a=this.input;b=h.offset;e=this.ua=[];f=this.va=[];g=h.offset+h.size;var q,l,p,r,s,t,E;for("shdr"!==h.type&&k(Error("invalid chunk type:"+h.type));b<g;){h=String.fromCharCode.apply(n,a.subarray(b,b+=20));c=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;d=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;q=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;l=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;p=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;r=a[b++];s=a[b++]<<24>>
24;t=a[b++]|a[b++]<<8;E=a[b++]|a[b++]<<8;d=new Int16Array((new Uint8Array(a.subarray(this.Y.offset+2*c,this.Y.offset+2*d))).buffer);q-=c;l-=c;if(0<p){var x=p,B=m,z=m,H=m,F=m;for(c=1;22050>x;){B=new Int16Array(2*d.length);z=F=0;for(H=d.length;z<H;++z)B[F++]=d[z],B[F++]=d[z];d=B;c*=2;x*=2}p*=c;q*=c;l*=c}e.push(d);f.push({Fa:h,ya:q,ca:l,sampleRate:p,la:r,oa:s,Ea:t,Ga:E})}this.input=n};
function J(d,c){for(var a=d.input,b=c.offset,e=c.offset+c.size,f,g,h=[];b<e;){b+=2;f=a[b++]|a[b++]<<8;g=L[f];if(g===m)h.push({type:g,value:{code:f,e:a[b]|a[b+1]<<8<<16>>16,k:a[b++],i:a[b++]}});else switch(g){case "keyRange":case "velRange":case "keynum":case "velocity":h.push({type:g,value:{k:a[b++],i:a[b++]}});break;default:h.push({type:g,value:{e:a[b++]|a[b++]<<8<<16>>16}})}b+=2;b+=2}return h}
function K(d,c){for(var a=d.input,b=c.offset,e=c.offset+c.size,f,g,h=[];b<e;)if(f=a[b++]|a[b++]<<8,g=L[f],g===m)h.push({type:g,value:{code:f,e:a[b]|a[b+1]<<8<<16>>16,k:a[b++],i:a[b++]}});else switch(g){case "keynum":case "keyRange":case "velRange":case "velocity":h.push({type:g,value:{k:a[b++],i:a[b++]}});break;default:h.push({type:g,value:{e:a[b++]|a[b++]<<8<<16>>16}})}return h}
function M(d,c,a){var b=[],e={za:[],keyRange:{i:127,k:0}},f;for(f=d;f<c;++f)d=a[f],b.push(d),"unknown"===d.type?e.za.push(d.value):e[d.type]=d.value;return{o:e,p:b}}
var L=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",,"chorusEffectsSend","reverbEffectsSend","pan",,,,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay",
"delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",,"scaleTuning","exclusiveClass","overridingRootKey"];function P(d){this.input=d;this.d=0;this.bufferSize=1024;var c;v.AudioContext!==m?c=new v.AudioContext:v.webkitAudioContext!==m?c=new v.webkitAudioContext:v.mozAudioContext!==m?c=new v.mozAudioContext:k(Error("Web Audio not supported"));c.createGainNode===m&&(c.createGainNode=c.createGain);this.c=c;this.h=this.c.createGainNode();this.ba=this.c.createDynamicsCompressor();this.s=this.c.createBufferSource();this.f=[0,1,2,3,4,5,6,7,8,0,10,11,12,13,14,15];this.G=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];this.C=
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.m=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];this.B=1/32768;this.R=16384}var ba="Acoustic Piano;Bright Piano;Electric Grand Piano;Honky-tonk Piano;Electric Piano;Electric Piano 2;Harpsichord;Clavi;Celesta;Glockenspiel;Musical box;Vibraphone;Marimba;Xylophone;Tubular Bell;Dulcimer;Drawbar Organ;Percussive Organ;Rock Organ;Church organ;Reed organ;Accordion;Harmonica;Tango Accordion;Acoustic Guitar (nylon);Acoustic Guitar (steel);Electric Guitar (jazz);Electric Guitar (clean);Electric Guitar (muted);Overdriven Guitar;Distortion Guitar;Guitar harmonics;Acoustic Bass;Electric Bass (finger);Electric Bass (pick);Fretless Bass;Slap Bass 1;Slap Bass 2;Synth Bass 1;Synth Bass 2;Violin;Viola;Cello;Double bass;Tremolo Strings;Pizzicato Strings;Orchestral Harp;Timpani;String Ensemble 1;String Ensemble 2;Synth Strings 1;Synth Strings 2;Voice Aahs;Voice Oohs;Synth Voice;Orchestra Hit;Trumpet;Trombone;Tuba;Muted Trumpet;French horn;Brass Section;Synth Brass 1;Synth Brass 2;Soprano Sax;Alto Sax;Tenor Sax;Baritone Sax;Oboe;English Horn;Bassoon;Clarinet;Piccolo;Flute;Recorder;Pan Flute;Blown Bottle;Shakuhachi;Whistle;Ocarina;Lead 1 (square);Lead 2 (sawtooth);Lead 3 (calliope);Lead 4 (chiff);Lead 5 (charang);Lead 6 (voice);Lead 7 (fifths);Lead 8 (bass + lead);Pad 1 (Fantasia);Pad 2 (warm);Pad 3 (polysynth);Pad 4 (choir);Pad 5 (bowed);Pad 6 (metallic);Pad 7 (halo);Pad 8 (sweep);FX 1 (rain);FX 2 (soundtrack);FX 3 (crystal);FX 4 (atmosphere);FX 5 (brightness);FX 6 (goblins);FX 7 (echoes);FX 8 (sci-fi);Sitar;Banjo;Shamisen;Koto;Kalimba;Bagpipe;Fiddle;Shanai;Tinkle Bell;Agogo;Steel Drums;Woodblock;Taiko Drum;Melodic Tom;Synth Drum;Reverse Cymbal;Guitar Fret Noise;Breath Noise;Seashore;Bird Tweet;Telephone Ring;Helicopter;Applause;Gunshot".split(";");
function Q(d){var c,a,b,e,f;d=d.T;d.parse();var g=d.qa,h=d.sa,q=[],l,p,r,s,t;s=0;for(t=g.length;s<t;++s){l=g[s].U;p=g[s+1]?g[s+1].U:h.length;for(r=[];l<p;++l)f=M(h[l].V,h[l+1]?h[l+1].V:d.W.length,d.W),b=f.o,c=f.p,e=M(h[l].v,h[l+1]?h[l+1].v:d.X.length,d.X),f=e.o,e=e.p,r.push({J:b,da:c,ja:f,ka:e}),b=b.instrument!==m?b.instrument.e:f.instrument!==m?f.instrument.e:n;q.push({name:g[s].ra,info:r,n:g[s],b:b})}h=d.b;r=d.ga;g=[];t=0;for(l=h.length;t<l;++t){p=h[t].K;b=h[t+1]?h[t+1].K:r.length;s=[];for(f=b;p<
f;++p)c=M(r[p].L,r[p+1]?r[p+1].L:d.M.length,d.M),b=c.o,e=c.p,a=M(r[p].v,r[p+1]?r[p+1].ea:d.N.length,d.N),c=a.o,a=a.p,s.push({J:b,da:e,ja:c,ka:a});g.push({name:h[t].fa,info:s})}h=[];l=0;for(p=q.length;l<p;++l)if(b=q[l],t=b.n.pa,"number"===typeof b.b&&(s=g[b.b],"EOI"!==s.name.replace(/\0*$/,""))){h[b.n.d]===m&&(h[b.n.d]=[]);r=h[b.n.d];r[t]=[];r[t].name=b.name;b=0;for(f=s.info.length;b<f;++b){c=d;e=r[t];a=s.info[b].J;var E=m,x=m,B=m,z=m,H=m,F=m,V=m,W=m,X=m,Y=m,Z=m,N=m,O=m,G=m,$=m;if(!(a.keyRange===m||
a.sampleID===m)){B=R(a,"attackVolEnv",-12E3);z=R(a,"decayVolEnv",-12E3);H=R(a,"sustainVolEnv");F=R(a,"releaseVolEnv",-12E3);V=R(a,"attackModEnv",-12E3);W=R(a,"decayModEnv",-12E3);X=R(a,"sustainModEnv");Y=R(a,"releaseModEnv",-12E3);Z=R(a,"coarseTune")+R(a,"fineTune")/100;N=R(a,"scaleTuning",100)/100;O=R(a,"freqVibLFO");G=a.keyRange.k;for($=a.keyRange.i;G<=$;++G)e[G]||(E=R(a,"sampleID"),x=c.va[E],e[G]={sample:c.ua[E],sampleRate:x.sampleRate,basePlaybackRate:Math.pow(Math.pow(2,1/12),(G-R(a,"overridingRootKey",
x.la)+Z+x.oa/100)*N),modEnvToPitch:R(a,"modEnvToPitch")/100,scaleTuning:N,start:32768*R(a,"startAddrsCoarseOffset")+R(a,"startAddrsOffset"),end:32768*R(a,"endAddrsCoarseOffset")+R(a,"endAddrsOffset"),loopStart:x.ya+32768*R(a,"startloopAddrsCoarseOffset")+R(a,"startloopAddrsOffset"),loopEnd:x.ca+32768*R(a,"endloopAddrsCoarseOffset")+R(a,"endloopAddrsOffset"),volAttack:Math.pow(2,B/1200),volDecay:Math.pow(2,z/1200),volSustain:H/1E3,volRelease:Math.pow(2,F/1200),modAttack:Math.pow(2,V/1200),modDecay:Math.pow(2,
W/1200),modSustain:X/1E3,modRelease:Math.pow(2,Y/1200),initialFilterFc:R(a,"initialFilterFc",13500),modEnvToFilterFc:R(a,"modEnvToFilterFc"),initialFilterQ:R(a,"initialFilterQ"),freqVibLFO:O?8.176*Math.pow(2,O/1200):m})}}}return h}function R(d,c,a){a===m&&(a=0);return d[c]?d[c].e:a}P.prototype.start=function(){this.s.connect(this.h);this.h.connect(this.c.destination);this.s.start(0);this.R=16383;this.h.gain.value=this.B*(16383/16384)};
P.prototype.stop=function(){this.s.disconnect(0);this.h.disconnect(0);this.ba.disconnect(0)};var S=["Instrument","Vol","Pan","Bend","Range"];
function ca(d){var c=d.a=document.createElement("table"),a=document.createElement("thead"),b=document.createElement("tbody"),e,f,g;a.appendChild(da(S,!0));for(f=0;16>f;++f){e=da(S.length+128,u);b.appendChild(e);if(9!==f){var h=document.createElement("select"),q;for(g=0;128>g;++g)q=document.createElement("option"),q.textContent=ba[g],h.appendChild(q);e.querySelector("td:nth-child(1)").appendChild(h);h.addEventListener("change",function(a,b){return function(c){T(a,b,c.target.selectedIndex)}}(d,f),u);
h.selectedIndex=d.f[f]}else e.querySelector("td:first-child").textContent="[ RHYTHM TRACK ]";e=e.querySelectorAll("td:nth-last-child(-n+128)");for(g=0;128>g;++g)e[g].addEventListener("mousedown",function(a,b,c){return function(d){d.preventDefault();a.H=!0;a.noteOn(b,c,127)}}(d,f,g)),e[g].addEventListener("mouseover",function(a,b,c){return function(d){d.preventDefault();a.H&&a.noteOn(b,c,127)}}(d,f,g)),e[g].addEventListener("mouseout",function(a,b,c){return function(d){d.preventDefault();a.noteOff(b,
c,0)}}(d,f,g)),e[g].addEventListener("mouseup",function(a,b,c){return function(d){d.preventDefault();a.H=u;a.noteOff(b,c,0)}}(d,f,g))}c.appendChild(a);c.appendChild(b);return c}function da(d,c){var a=document.createElement("tr"),b,e=d instanceof Array,f,g=e?d.length:d;for(f=0;f<g;++f)b=document.createElement(c?"th":"td"),b.textContent=e&&d[f]!==m?d[f]:"",a.appendChild(b);return a}
P.prototype.noteOn=function(d,c,a){var b=this.r[9===d?128:this.d][this.f[d]];this.a&&this.a.querySelector("tbody > tr:nth-child("+(d+1)+") > td:nth-child("+(S.length+c+1)+")").classList.add("note-on");if(b)if(b=b[c]){var e=this.C[d]-64;b.channel=d;b.key=c;b.velocity=a;b.panpot=e/(0>e?64:63);b.volume=this.G[d]/127;b.pitchBend=this.D[d]-8192;b.pitchBendSensitivity=this.F[d];c=new y(this.c,this.h,b);c.noteOn();this.m[d].push(c)}else v.console.warn("instrument not found: bank=%s instrument=%s channel=%s key=%s",
9===d?128:this.d,this.f[d],d,c);else v.console.warn("instrument not found: bank=%s instrument=%s channel=%s",9===d?128:this.d,this.f[d],d)};P.prototype.noteOff=function(d,c){var a=this.r[9===d?128:this.d][this.f[d]],b,e=this.m[d],f;this.a&&this.a.querySelector("tbody > tr:nth-child("+(d+1)+") > td:nth-child("+(c+S.length+1)+")").classList.remove("note-on");if(a){a=0;for(b=e.length;a<b;++a)f=e[a],f.key===c&&(f.noteOff(),e.splice(a,1),--a,--b)}};
function T(d,c,a){d.a&&9!==c&&(d.a.querySelector("tbody > tr:nth-child("+(c+1)+") > td:first-child > select").selectedIndex=a);9!==c&&(d.f[c]=a)}function ea(d,c,a){d.a&&(d.a.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child(2)").textContent=a);d.G[c]=a}function fa(d,c,a){d.a&&(d.a.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child(3)").textContent=a);d.C[c]=a}
P.prototype.l=function(d,c,a){c=c&127|(a&127)<<7;var b,e=this.m[d],f=c-8192;this.a&&(this.a.querySelector("tbody > tr:nth-child("+(d+1)+") > td:nth-child(4)").textContent=f);a=0;for(b=e.length;a<b;++a)A(e[a],f);this.D[d]=c};P.prototype.q=function(d,c){this.a&&(this.a.querySelector("tbody > tr:nth-child("+(d+1)+") > td:nth-child(5)").textContent=c);this.F[d]=c};function U(){this.A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.ha=this.onmessage.bind(this);window.addEventListener("DOMContentLoaded",function(){this.ta=!0}.bind(this),u)}U.prototype.xa=function(d,c){c=c||{};this.ta?this.load(d,c):window.addEventListener("DOMContentLoaded",function b(){window.removeEventListener("DOMContentLoaded",b,u);this.load(d,c)}.bind(this),u)};
U.prototype.load=function(d,c){var a=new XMLHttpRequest;a.open("GET",d,!0);a.responseType="arraybuffer";a.addEventListener("load",function(a){a=a.target;this.onload(a.response,c);"function"===typeof this.O&&this.O(a.response)}.bind(this),u);a.send()};U.prototype.onload=function(d,c){var a=new Uint8Array(d);this.P(a,c)};
U.prototype.P=function(d,c){var a;if(this.w)a=this.w,a.input=d,a.T=new I(d),a.r=Q(a);else{a=this.w=new P(d);"headless"in c||document.body.appendChild(ca(a));var b=a,e;b.T=new I(b.input);b.r=Q(b);for(e=0;16>e;++e)T(b,e,e),ea(b,e,100),fa(b,e,64),b.l(e,0,64),b.q(e,2);a.start();window.addEventListener("message",this.ha,u)}window.opener?window.opener.postMessage("link,ready","*"):window.parent!==window&&window.parent.postMessage("link,ready","*")};
U.prototype.onmessage=function(d){d=d.data.split(",");switch(d.shift()){case "midi":ga(this,d.map(function(c){return parseInt(c,16)}));break;case "link":d=d.shift();switch(d){case "reqpatch":window.opener?window.opener.postMessage("link,patch","*"):window.parent!==window&&window.parent.postMessage("link,patch","*");break;case "setpatch":break;default:v.console.error("unknown link message:",d)}break;default:v.console.error("unknown message type")}};U.prototype.wa=function(d){this.O=d};
function ga(d,c){var a=c[0]&15,b=d.w;switch(c[0]&240){case 128:b.noteOff(a,c[1],c[2]);break;case 144:0<c[2]?b.noteOn(a,c[1],c[2]):b.noteOff(a,c[1],0);break;case 176:switch(c[1]){case 6:switch(d.A[a]){case 0:switch(d.z[a]){case 0:b.q(a,c[2])}}break;case 7:ea(b,a,c[2]);break;case 10:fa(b,a,c[2]);break;case 120:for(var e=b.m[a];0<e.length;)b.noteOff(a,e[0].key,0);break;case 121:b.l(a,0,64);break;case 100:d.A[a]=c[2];break;case 101:d.z[a]=c[2]}break;case 192:T(b,a,c[1]);break;case 224:b.l(a,c[1],c[2]);
break;case 240:switch(c[1]){case 127:switch(c[3]){case 4:switch(c[4]){case 1:a=c[5]+(c[6]<<7),b.R=a,b.h.gain.value=b.B*(a/16384)}}}}};w("SoundFont.WebMidiLink",U);w("SoundFont.WebMidiLink.prototype.setup",U.prototype.xa);w("SoundFont.WebMidiLink.prototype.loadSoundFont",U.prototype.P);w("SoundFont.WebMidiLink.prototype.setLoadCallback",U.prototype.wa);}).call(this); //@ sourceMappingURL=sf2synth.min.js.map
